<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>GD Word Chain</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    fieldset {
      margin-bottom: 16px;
    }
    #history {
      margin-top: 12px;
      min-height: 24px;
      font-weight: bold;
    }
    #status {
      margin-top: 8px;
      color: #333;
    }
    .disabled {
      opacity: 0.5;
    }
  </style>
</head>
<body>

  <h1>GD Word Chain</h1>

  <!-- =====================
       설정 영역
  ====================== -->
  <fieldset id="optionArea">
    <legend>게임 설정</legend>

    <label>
      <input type="checkbox" id="optPlatformer" checked />
      Platformer 포함
    </label>
    <br />

    <label>
      <input type="checkbox" id="optYesNum" checked />
      숫자 포함 단어 사용
    </label>
    <br />

    <label id="ignoreNumLabel" class="disabled">
      <input type="checkbox" id="optIgnoreNum" disabled />
      맨 뒤 숫자 무시
    </label>
    <br />

    <label>
      <input type="checkbox" id="optNoOneShot" />
      한방단어 금지
    </label>

    <hr />

    <label>
      모드:
      <select id="optMode">
        <option value="solo">Solo Mode</option>
        <option value="computer">Computer Mode</option>
      </select>
    </label>

    <hr />

    <label>
      시작 글자:
      <input type="text" id="startChar" maxlength="1" value="a" />
    </label>
  </fieldset>

  <!-- =====================
       버튼 영역
  ====================== -->
  <button id="btnStart">Game Start</button>
  <button id="btnReset" style="display:none;">Game Reset</button>
  <button id="btnEnd" style="display:none;">Game End</button>

  <hr />

  <!-- =====================
       인게임 영역
  ====================== -->
  <div id="gameArea" style="display:none;">
    <input
      type="text"
      id="wordInput"
      placeholder="단어 입력 후 Enter"
      autocomplete="off"
    />
    <div id="status"></div>
    <div id="history"></div>
  </div>

  <!-- =====================
       스크립트
  ====================== -->
  <script src="game.js"></script>
  <script>
    const optPlatformer = document.getElementById("optPlatformer");
    const optYesNum = document.getElementById("optYesNum");
    const optIgnoreNum = document.getElementById("optIgnoreNum");
    const ignoreNumLabel = document.getElementById("ignoreNumLabel");
    const optNoOneShot = document.getElementById("optNoOneShot");
    const optMode = document.getElementById("optMode");
    const startCharInput = document.getElementById("startChar");

    const btnStart = document.getElementById("btnStart");
    const btnReset = document.getElementById("btnReset");
    const btnEnd = document.getElementById("btnEnd");

    const gameArea = document.getElementById("gameArea");
    const optionArea = document.getElementById("optionArea");

    /* ---------------------
       체크박스 의존성
    --------------------- */
    optYesNum.addEventListener("change", () => {
      if (!optYesNum.checked) {
        optIgnoreNum.checked = false;
        optIgnoreNum.disabled = true;
        ignoreNumLabel.classList.add("disabled");
      } else {
        optIgnoreNum.disabled = false;
        ignoreNumLabel.classList.remove("disabled");
      }
    });

    /* ---------------------
       게임 시작
    --------------------- */
    btnStart.addEventListener("click", async () => {
      const startChar = startCharInput.value.trim();
      if (!startChar) {
        alert("시작 글자를 입력하세요.");
        return;
      }

      const option = {
        usePlatformer: optPlatformer.checked,
        useYesNum: optYesNum.checked,
        ignoreNumber: optIgnoreNum.checked,
        noOneShot: optNoOneShot.checked,
        mode: optMode.value
      };

      await startGame(startChar, option);

      optionArea.disabled = true;
      gameArea.style.display = "block";

      btnStart.style.display = "none";
      btnReset.style.display = "inline";
      btnEnd.style.display = "inline";
    });

    /* ---------------------
       게임 리셋
    --------------------- */
    btnReset.addEventListener("click", async () => {
      const option = {
        usePlatformer: optPlatformer.checked,
        useYesNum: optYesNum.checked,
        ignoreNumber: optIgnoreNum.checked,
        noOneShot: optNoOneShot.checked,
        mode: optMode.value
      };

      await startGame(startCharInput.value, option);
    });

    /* ---------------------
       게임 종료
    --------------------- */
    btnEnd.addEventListener("click", () => {
      location.reload();
    });
  </script>

</body>
</html>
